# üîê One-Time Secret Service (FastAPI + PostgreSQL)

REST API-—Å–µ—Ä–≤–∏—Å –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–π –ø–µ—Ä–µ–¥–∞—á–∏ —Å–µ–∫—Ä–µ—Ç–æ–≤.  
–°–µ–∫—Ä–µ—Ç –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Å –∫–æ–¥–æ–≤–æ–π —Ñ—Ä–∞–∑–æ–π –∏ –ø–æ–ª—É—á–∏—Ç—å –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–π –∫–æ–¥ –¥–ª—è –µ–≥–æ –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞.

## üì¶ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–∞ —Å –∫–æ–¥–æ–≤–æ–π —Ñ—Ä–∞–∑–æ–π
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–≥–æ –∫–æ–¥–∞ –¥–æ—Å—Ç—É–ø–∞
- –û–¥–∏–Ω –ø—Ä–æ—Å–º–æ—Ç—Ä —Å–µ–∫—Ä–µ—Ç–∞ –ø–æ –∫–æ–¥—É, –ø–æ—Å–ª–µ —á–µ–≥–æ –æ–Ω —É–¥–∞–ª—è–µ—Ç—Å—è
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Swagger/OpenAPI

---

## üß± –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

- [FastAPI](https://fastapi.tiangolo.com/)
- [PostgreSQL](https://www.postgresql.org/)
- [SQLAlchemy](https://docs.sqlalchemy.org/)
- [SQLModel] (https://sqlmodel.tiangolo.com/about/)
- [pytest] (https://pypi.org/project/pytest/)
- [Docker](https://docs.docker.com/compose/)
- [uv](https://github.com/astral-sh/uv) ‚Äî –º–µ–Ω–µ–¥–∂–µ—Ä –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- [ruff] (https://docs.astral.sh/ruff/)
- [mypy] https://mypy-lang.org/
---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (Docker)

1. –ö–ª–æ–Ω–∏—Ä—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

- git clone https://github.com/BagRoman01/secrets.git

2. –°–æ–∑–¥–∞–π `.env` —Ñ–∞–π–ª (–ø—Ä–∏–º–µ—Ä –Ω–∏–∂–µ) –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π.

3. –ü–æ—Å—Ç—Ä–æ–π –∏ –∑–∞–ø—É—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å:

- docker compose up --build

4. –û—Ç–∫—Ä–æ–π API-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é:

* Swagger UI: [http://localhost:8000/docs]
  
---

## ‚öôÔ∏è –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (`.env`)

```env
# DATABASE
DATABASE_HOST=db
DATABASE_PORT=5432
DATABASE_USER=postgres
DATABASE_PASS=postgres
DATABASE_NAME=test_db

# FRONTEND COMMUNICATION
CORS_ORIGINS=http://localhost:3000,http://PRODUCTION.example.com

# DEPLOYMENT
DEPLOY_HOST=127.0.0.1
DEPLOY_PORT=8000
```

---

## üêò –°—Ç—Ä—É–∫—Ç—É—Ä–∞ `docker-compose.yml`

* `db` ‚Äî PostgreSQL 15 —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏.
* `app` ‚Äî FastAPI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ Python 3.12.

---

## üì¶ –ü—Ä–∏–º–µ—Ä—ã API

### üîê –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–∞

`POST /generate`

–°–æ–∑–¥–∞—ë—Ç –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–π —Å–µ–∫—Ä–µ—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–æ–¥ –¥–ª—è –µ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è.
–ù–∞ —Å–µ–∫—Ä–µ—Ç –∏ –ø–∞—Ä–æ–ª—å –Ω–∞–ª–æ–∂–µ–Ω—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
    secret: constr(min_length=1, max_length=65536)
    password: constr(min_length=3, max_length=64)

#### üî∏ –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:

```json
{
  "secret": "secret",
  "password": "parol"
}
```

#### üî∏ –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:

```json
{
  "reg_date": "2025-07-26T18:33:42.099375",
  "secret": "fcdaa0dba711b55e20925072ec1a34dd674141414141426f68522d46745534626730714a74513765386574394a697269735a47482d6d7975696c6b685a6956665f55683161456a5752796934325568743471364a375f31476b324b7670496e77705339424f6e7974645156474f364e6679413d3d",
  "hashed_password": "$2b$12$FY0rvglUqiRSV7K.lYmcuetPyM6e4i3ptb141CUzCGkRxdKByMheS",
  "id": "260b98ba-4b80-45e3-ab5f-7f5f6f16bd4b"
}
```

---
### üì• –ü–æ–ª—É—á–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–∞

`POST /unlock/{id}`

–ü–æ–∑–≤–æ–ª—è–µ—Ç –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Ä–∞–Ω–µ–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Å–µ–∫—Ä–µ—Ç. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –æ–Ω —É–¥–∞–ª—è–µ—Ç—Å—è.

#### üî∏ –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:

```json
{
  "id": "260b98ba-4b80-45e3-ab5f-7f5f6f16bd4b",
  "password": "parol"
}
```

#### üî∏ –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:

```json
{
  "reg_date": "2025-07-26T18:33:42.099375",
  "secret": "secret"
}
```

#### ‚ö†Ô∏è –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –¥–æ—Å—Ç—É–ø:

–ï—Å–ª–∏ —Ç–æ—Ç –∂–µ `code` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ ‚Äî –±—É–¥–µ—Ç –æ—à–∏–±–∫–∞ `404 Not Found`, –ø–æ—Ç–æ–º—É —á—Ç–æ —Å–µ–∫—Ä–µ—Ç —É–∂–µ —É–¥–∞–ª—ë–Ω.
```json
{
  "errors": "Secret with this id was not found!"
}
```
